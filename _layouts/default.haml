!!!strict

%html{html_attrs}

  %head
    %meta{ :"http-equiv" => 'Content-Type', :content => 'text/html; charset=utf-8' }
    %title= page.title
    %meta{ :name => 'author', :content => 'Henrik Nyh (http://henrik.nyh.se)' }
    %link{ :href => FEED_URL, :rel => "alternate", :title => "The Pug Automatic", :type => "application/atom+xml" }
    
    %link{ :rel => "openid.server",   :href => "http://openid.nyh.se/henrik" }
    %link{ :rel => "openid.delegate", :href => "http://openid.nyh.se/henrik" }
    
    %link{ :rel => "stylesheet", :type => 'text/css', :href => '/css/syntax.css' }
    %link{ :rel => "stylesheet", :type => 'text/css', :href => '/css/screen.css' }
    %link{ :rel => "stylesheet", :type => 'text/css', :href => '/css/style.css' }

  %body
    .site
    
      .sidebar

        .title
          %p= link_to('<img src="/images/pug.png" alt="" />', "/")
          %p= link_to("The Pug Automatic", "/")

        -# top_tags = site.tags.map {|t,ps| [t, ps.length] }.sort_by {|t,c| -c }.map {|t,c| t }[0,3]
        %p A blog by Henrik Nyh mostly on Ruby, Rails and OS X automation.
        %p (The blog is changing code. Comments and more styling forthcoming.)
        -# Mostly on 
        =# tag_links(top_tags, has_tag=false), "."
        -#%p
        -#  Also
        -# more_tags = (site.tags.keys - top_tags).sort_by {|tag| tag.downcase }
        =# tag_links(more_tags, has_tag=false), "."
          
      .content= content
      
      .footer
        .contact
          %p= link_to('RSS', FEED_URL)
        .contact
          %p= link_to('henrik@nyh.se', 'mailto:henrik@nyh.se')
        .contact
          %p
            Powered by
            = link_to('Jekyll', 'http://github.com/henrik/jekyll')
            and
            = link_to('Disqus', 'http://disqus.com'), '.'
        .contact
          -#%p
          -#  = link_to('github.com/henrik', 'http://github.com/henrik')
          -#  %br
          -#  = link_to('twitter.com/henrik', 'http://twitter.com/henrik')
          -#  %br
          -#  = link_to('flickr.com/photos/malesca', 'http://flickr.com/photos/malesca')

      :javascript
      
        // Google Analytics
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
        </script>
        <script type="text/javascript">
        try {
        var pageTracker = _gat._getTracker("UA-8429899-1");
        pageTracker._trackPageview();
        } catch(err) {}

        // Disqus
        (function() {
          var links = document.getElementsByTagName('a');
          var query = '?';
          for(var i = 0; i < links.length; i++) {
            if(links[i].href.indexOf('#disqus_thread') >= 0) {
              query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
            }
          }
          document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/henrikn/get_num_replies.js' + query + '"></' + 'script>');
        })();
